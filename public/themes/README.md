# Глобальные темы пользователей

Важным функционалом для любого интернет-ресурса является кастомизация внешнего вида, в зависимости от желания пользователей. И если прицнип локализации встроен в сам фреймворк, то что делать с другими аспектами?

В данном приложении была реализована система глобальных тем интерфейса. Для примера были взяты светлая и тёмная темы. Для доступа к стилям, они были помещены в директорию ```public```.

В стилях изменяются параметры элементов пользовательского интерфейса.

## Настройка тем

Также, как и локализация, данные о стилях пользователей хранятся в БД ```Redis```. 

Свою тему, пользователь может настроить на странице профиля, соответствующей кнопкой.

При переходе, вызывается роутинг ```/profile/theme```: ```Route::get('/profile/theme/{theme}', [ProfileController::class, 'setTheme'])->middleware('auth')->name('setTheme');```. Из него происходит вызов метода ```setTheme``` в [ProfileController-е](https://github.com/DavidaaWoW/LaravelCarServiceApplication/blob/main/app/Http/Controllers/ProfileController.php).

Внутри него происходит взаимодействие с БД ```Redis```, откуда сначала вытаскивается актуальная информация в виде ```JSON``` файла, затем в нём заменяется параметр ```theme```, после чего, новый JSON опять помещается в хранилище.

## Инициализация

Для инициализации тем был написан [ThemeProvider](https://github.com/DavidaaWoW/LaravelCarServiceApplication/blob/main/app/Providers/ThemeProvider.php). 

[Провайдеры](https://laravel.com/docs/9.x/providers#main-content) отвечают за первоначальную инициализацию и запуск приложения. ```ThemeProvider``` в данном случае пользуется механизмом [композеров](https://laravel.com/docs/9.x/views#view-composers). Первым параметром передаётся ```view```, в данном случае, знак ```*``` отвечает за прослушивание всех ```view```, а вторым, коллбек функция, которая тут обращается к отдельному классу композеру, но может быть реализована на месте.

[ThemeComposer](https://github.com/DavidaaWoW/LaravelCarServiceApplication/blob/main/app/View/Composers/ThemeComposer.php) проверяет аутентификацию пользователя, после чего запрашивает данные о теме от ```БД Redis```. В зависимости от результата, во ```view``` отправляется то, или иное название файла.

## Применение тем

Благодаря тому, что всё приложение построено на шаблонах Blade, для полноценной работы тем, их необходимо подключить лишь в один файл - ```app.blade.php```.

Где внутри ```head``` мы указываем ссылку на темы, при этом, значение ссылки динамическое, и зависит как раз от переданной переменной ```_style```.

```
<link rel="stylesheet" href="/themes/{{ $_style }}">
```
